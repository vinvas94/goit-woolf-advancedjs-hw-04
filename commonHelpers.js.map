{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nconst API_KEY = '40010712-6d7af93e262d6e116d716f3d5';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\naxios.interceptors.response.use(\n  response => {\n    return response;\n  },\n  error => {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n      position: 'topRight',\n      progressBarColor: 'red',\n    });\n    return Promise.reject(error);\n  }\n);\n\nasync function getImages(query, page, perPage) {\n  const response = await axios.get(\n    `?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n  );\n  return response.data;\n}\n\nexport { getImages };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getImages } from './api';\n\nlet page = 1;\nlet query = null;\nlet perPage = 40;\n\nlet simpleLightbox;\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  buttonLoad: document.querySelector('.load-more'),\n  list: document.querySelector('.gallery'),\n};\n\nfunction createMarkup(arr) {\n  if (!refs.list) {\n    return;\n  }\n  const markup = arr\n    .map(arr => {\n      const {\n        id,\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = arr;\n\n      return `\n      \n      <div class=\"photo-card\" id=\"${id}\">\n  <a  href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/></a>\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes</b>: ${likes}\n    </p>\n    <p class=\"info-item\">\n      <b>Views</b>: ${views}\n    </p>\n    <p class=\"info-item\">\n      <b>Comments</b>: ${comments}\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads</b>: ${downloads}\n    </p>\n  </div>\n</div>`;\n    })\n\n    .join('');\n  refs.list.insertAdjacentHTML('beforeend', markup);\n}\n\nrefs.form.addEventListener('submit', onSearch);\n\nfunction onSearch(evt) {\n  evt.preventDefault();\n\n  page = 1;\n  refs.list.innerHTML = '';\n  query = evt.currentTarget.searchQuery.value.trim();\n\n  if (query === '') {\n    iziToast.warning({\n      title: 'Hey',\n      message: 'Please specify your search query',\n      position: 'topRight',\n    });\n\n    return;\n  }\n\n  getImages(query, page, perPage)\n    .then(data => {\n      if (data.hits.length * page === data.totalHits) {\n        refs.buttonLoad.classList.add('hide');\n      } else {\n        refs.buttonLoad.classList.remove('hide');\n      }\n      if (data.totalHits === 0) {\n        iziToast.error({\n          title: 'Hey',\n          message:\n            'Sorry, there are no images matching your search query. Please try again.',\n          position: 'topRight',\n        });\n      } else {\n        createMarkup(data.hits);\n        simpleLightboxList();\n        iziToast.success({\n          title: 'OK',\n          message: `Hooray! We found ${data.totalHits} images.`,\n          position: 'topRight',\n        });\n      }\n    })\n    .catch(error => {\n      console.log(error);\n    })\n    .finally(() => refs.form.reset());\n}\n\nfunction simpleLightboxList() {\n  if (simpleLightbox) {\n    simpleLightbox.refresh();\n  } else {\n    simpleLightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n      enableKeyboard: true,\n    });\n  }\n}\n\nrefs.buttonLoad.addEventListener('click', onButtonLoad);\n\nfunction onButtonLoad() {\n  page += 1;\n  getImages(query, page, perPage)\n    .then(data => {\n      if (perPage * page >= data.totalHits) {\n        refs.buttonLoad.classList.add('hide');\n        iziToast.warning({\n          title: 'Hey',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n      createMarkup(data.hits);\n      simpleLightboxList();\n    })\n    .catch(error => console.log(error));\n}\n\n// window.addEventListener('scroll', onScroll);\n\n// function onScroll() {\n//   const { scrollTop, clientHeight, scrollHeight } = document.documentElement;\n//   if (scrollTop + clientHeight >= scrollHeight - 200) {\n//     onButtonLoad();\n//   }\n// }\n\n// onScroll();\n"],"names":["API_KEY","axios","response","error","iziToast","getImages","query","page","perPage","simpleLightbox","refs","createMarkup","arr","markup","id","webformatURL","largeImageURL","tags","likes","views","comments","downloads","onSearch","evt","data","simpleLightboxList","SimpleLightbox","onButtonLoad"],"mappings":"owBAGA,MAAMA,EAAU,qCAEhBC,EAAM,SAAS,QAAU,2BAEzBA,EAAM,aAAa,SAAS,IAC1BC,GACSA,EAETC,IACEC,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,WACV,iBAAkB,KACxB,CAAK,EACM,QAAQ,OAAOD,CAAK,EAE/B,EAEA,eAAeE,EAAUC,EAAOC,EAAMC,EAAS,CAI7C,OAHiB,MAAMP,EAAM,IAC3B,QAAQD,OAAaM,kEAAsEC,cAAiBC,GAChH,GACkB,IAClB,CCrBA,IAAID,EAAO,EACPD,EAAQ,KACRE,EAAU,GAEVC,EAEJ,MAAMC,EAAO,CACX,KAAM,SAAS,cAAc,cAAc,EAC3C,WAAY,SAAS,cAAc,YAAY,EAC/C,KAAM,SAAS,cAAc,UAAU,CACzC,EAEA,SAASC,EAAaC,EAAK,CACzB,GAAI,CAACF,EAAK,KACR,OAEF,MAAMG,EAASD,EACZ,IAAIA,GAAO,CACV,KAAM,CACJ,GAAAE,EACA,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGT,EAEJ,MAAO;AAAA;AAAA,oCAEuBE;AAAA,cACtBE,gBAA4BD,WAAsBE;AAAA;AAAA;AAAA,sBAG1CC;AAAA;AAAA;AAAA,sBAGAC;AAAA;AAAA;AAAA,yBAGGC;AAAA;AAAA;AAAA,0BAGCC;AAAA;AAAA;AAAA,OAI1B,CAAK,EAEA,KAAK,EAAE,EACVX,EAAK,KAAK,mBAAmB,YAAaG,CAAM,CAClD,CAEAH,EAAK,KAAK,iBAAiB,SAAUY,CAAQ,EAE7C,SAASA,EAASC,EAAK,CAOrB,GANAA,EAAI,eAAc,EAElBhB,EAAO,EACPG,EAAK,KAAK,UAAY,GACtBJ,EAAQiB,EAAI,cAAc,YAAY,MAAM,KAAI,EAE5CjB,IAAU,GAAI,CAChBF,EAAS,QAAQ,CACf,MAAO,MACP,QAAS,mCACT,SAAU,UAChB,CAAK,EAED,MACD,CAEDC,EAAUC,EAAOC,EAAMC,CAAO,EAC3B,KAAKgB,GAAQ,CACRA,EAAK,KAAK,OAASjB,IAASiB,EAAK,UACnCd,EAAK,WAAW,UAAU,IAAI,MAAM,EAEpCA,EAAK,WAAW,UAAU,OAAO,MAAM,EAErCc,EAAK,YAAc,EACrBpB,EAAS,MAAM,CACb,MAAO,MACP,QACE,2EACF,SAAU,UACpB,CAAS,GAEDO,EAAaa,EAAK,IAAI,EACtBC,IACArB,EAAS,QAAQ,CACf,MAAO,KACP,QAAS,oBAAoBoB,EAAK,oBAClC,SAAU,UACpB,CAAS,EAET,CAAK,EACA,MAAMrB,GAAS,CACd,QAAQ,IAAIA,CAAK,CACvB,CAAK,EACA,QAAQ,IAAMO,EAAK,KAAK,MAAO,CAAA,CACpC,CAEA,SAASe,GAAqB,CACxBhB,EACFA,EAAe,QAAO,EAEtBA,EAAiB,IAAIiB,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,IACd,eAAgB,EACtB,CAAK,CAEL,CAEAhB,EAAK,WAAW,iBAAiB,QAASiB,CAAY,EAEtD,SAASA,GAAe,CACtBpB,GAAQ,EACRF,EAAUC,EAAOC,EAAMC,CAAO,EAC3B,KAAKgB,GAAQ,CACRhB,EAAUD,GAAQiB,EAAK,YACzBd,EAAK,WAAW,UAAU,IAAI,MAAM,EACpCN,EAAS,QAAQ,CACf,MAAO,MACP,QAAS,6DACT,SAAU,UACpB,CAAS,GAEHO,EAAaa,EAAK,IAAI,EACtBC,GACN,CAAK,EACA,MAAMtB,GAAS,QAAQ,IAAIA,CAAK,CAAC,CACtC"}