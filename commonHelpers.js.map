{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nconst API_KEY = '40010712-6d7af93e262d6e116d716f3d5';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\naxios.interceptors.response.use(\n  response => {\n    return response;\n  },\n  error => {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n      position: 'topRight',\n      progressBarColor: 'red',\n    });\n    return Promise.reject(error);\n  }\n);\n\nasync function getImages(query, page, perPage) {\n  const response = await axios.get(\n    `?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n  );\n  return response.data;\n}\n\nexport { getImages };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getImages } from './api';\n\nlet page = 1;\nlet query = null;\nlet perPage = 40;\n\nlet simpleLightbox;\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  buttonLoad: document.querySelector('.load-more'),\n  list: document.querySelector('.gallery'),\n};\n\nfunction createMarkup(arr) {\n  if (!refs.list) {\n    return;\n  }\n  const markup = arr\n    .map(arr => {\n      const {\n        id,\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = arr;\n\n      return `\n      \n      <div class=\"photo-card\" id=\"${id}\">\n  <a  href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/></a>\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes</b>: ${likes}\n    </p>\n    <p class=\"info-item\">\n      <b>Views</b>: ${views}\n    </p>\n    <p class=\"info-item\">\n      <b>Comments</b>: ${comments}\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads</b>: ${downloads}\n    </p>\n  </div>\n</div>`;\n    })\n\n    .join('');\n  refs.list.insertAdjacentHTML('beforeend', markup);\n}\n\nrefs.form.addEventListener('submit', onSearch);\n\nasync function fetchData(query, page, perPage) {\n  try {\n    const data = await getImages(query, page, perPage);\n    return data;\n  } catch (error) {\n    console.log(error);\n    throw error;\n  }\n}\n\nasync function onSearch(evt) {\n  evt.preventDefault();\n\n  refs.buttonLoad.classList.add('hide');\n  page = 1;\n  refs.list.innerHTML = '';\n  query = evt.currentTarget.searchQuery.value.trim();\n\n  if (query === '') {\n    iziToast.warning({\n      title: 'Hey',\n      message: 'Please specify your search query',\n      position: 'topRight',\n    });\n\n    return;\n  }\n\n  try {\n    const data = await fetchData(query, page, perPage);\n\n    if (data.hits.length * page === data.totalHits) {\n      refs.buttonLoad.classList.add('hide');\n    } else {\n      refs.buttonLoad.classList.remove('hide');\n    }\n\n    if (data.totalHits === 0) {\n      iziToast.error({\n        title: 'Hey',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n    } else {\n      createMarkup(data.hits);\n      refs.buttonLoad.classList.remove('hide');\n      simpleLightboxList();\n      iziToast.success({\n        title: 'OK',\n        message: `Hooray! We found ${data.totalHits} images.`,\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    refs.form.reset();\n  }\n}\n\nfunction simpleLightboxList() {\n  if (simpleLightbox) {\n    simpleLightbox.refresh();\n  } else {\n    simpleLightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n      enableKeyboard: true,\n    });\n  }\n}\n\nrefs.buttonLoad.addEventListener('click', onButtonLoad);\n\nasync function onButtonLoad() {\n  page += 1;\n  try {\n    const data = await fetchData(query, page, perPage);\n    if (perPage * page >= data.totalHits) {\n      refs.buttonLoad.classList.add('hide');\n      iziToast.warning({\n        title: 'Hey',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n    createMarkup(data.hits);\n    simpleLightboxList();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// window.addEventListener('scroll', onScroll);\n\n// function onScroll() {\n//   const { scrollTop, clientHeight, scrollHeight } = document.documentElement;\n//   if (scrollTop + clientHeight >= scrollHeight - 200) {\n//     onButtonLoad();\n//   }\n// }\n\n// onScroll();\n"],"names":["API_KEY","axios","response","error","iziToast","getImages","query","page","perPage","simpleLightbox","refs","createMarkup","arr","markup","id","webformatURL","largeImageURL","tags","likes","views","comments","downloads","onSearch","fetchData","evt","data","simpleLightboxList","SimpleLightbox","onButtonLoad"],"mappings":"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"}